apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: skaha-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /skaha/$2
    nginx.ingress.kubernetes.io/auth-tls-verify-client: "optional"
    nginx.ingress.kubernetes.io/auth-tls-secret: "development/all-cacert"
#    nginx.ingress.kubernetes.io/auth-tls-secret: "development/gridcanada-cacert"
#    nginx.ingress.kubernetes.io/auth-tls-secret: "cadc-cacert"
    nginx.ingress.kubernetes.io/auth-tls-verify-depth: "10"
#    nginx.ingress.kubernetes.io/auth-tls-error-page: "https://www.canfar.net"
#    nginx.ingress.kubernetes.io/auth-tls-pass-certificate-to-upstream: "false"
    nginx.ingress.kubernetes.io/proxy_set_header: X-Client-Certificate $ssl_client_escaped_cert
    nginx.ingress.kubernetes.io/proxy-body-size: 100g
spec:
  {{- if .Values.ingress.skahaIngress.tls }}
  tls: {{ toYaml .Values.ingress.skahaIngress.tls | nindent 2 }}
  {{- end }}
  rules: {{ toYaml .Values.ingress.skahaIngress.rules | nindent 2 }}
